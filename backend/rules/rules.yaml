rules:
  - id: "block_sensitive_contexts"
    type: "context_block"
    match: ["hr_data", "prod_credentials"]
    risk: 40

  - id: "block_prompt_injection"
    type: "payload_contains"
    match:
      - "ignore previous instructions"
      - "delete all files"
      - "send confidential"
    risk: 80

  - id: "block_external_links"
    type: "payload_regex"
    pattern: "https?://[^ ]+"
    risk: 50

  # NEW RULES that would trigger on your logs
  - id: "security_alert_context"
    type: "context_block"
    match: ["security-alert"]
    risk: 60

  - id: "system_error_context"
    type: "context_block"
    match: ["system-error"]
    risk: 30

  - id: "unauthorized_access_payload"
    type: "payload_contains"
    match:
      - "unauthorized access"
      - "connection pool exhausted"
      - "failed login"
    risk: 70

  - id: "ip_address_detection"
    type: "payload_regex"
    pattern: "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"
    risk: 25

  - id: "heartbeat_low_risk"
    type: "context_block"
    match: ["heartbeat"]
    risk: 5 # Assign a low risk to heartbeats for demonstration